# ç¬é—´

è¿™æ˜¯ä¸€ä¸ªèƒ½è®©ä½ å‘åŠ¨æ€çš„ç½‘é¡µé¡¹ç›®

å…·ä½“åŠŸèƒ½:
- 1.ä½ å¯ä»¥é€šè¿‡ç½‘é¡µæˆ–è€…å®¢æˆ·ç«¯(å®‰å“)è¿›è¡Œç®¡ç†åœ¨æœåŠ¡ç«¯çš„åŠ¨æ€
- 2.å®ç°mdè¯­æ³•ä¸æ¸²æŸ“
- 3.æ”¯æŒåµŒå…¥HTML
- 4.ç½‘é¡µå‰åç«¯ä¸€ä½“ï¼Œå®æ—¶æ¸²æŸ“

## é¡¹ç›®æ¶æ„

```
/
â”‚
â”œâ”€â”€ server.py                     # æœåŠ¡ç«¯ï¼ˆFlaskï¼‰
â”‚
â”œâ”€â”€ config.yaml                   # é…ç½®æ–‡ä»¶  
â”‚
â”œâ”€â”€ templates/                    # ç½‘é¡µæ–‡ä»¶ç›®å½•
â”‚     â”œâ”€â”€ index.html              # åŠ¨æ€å±•ç¤ºé¡µé¢
â”‚     â”œâ”€â”€ status.html             # çŠ¶æ€å†å²æŸ¥çœ‹
â”‚     â”œâ”€â”€ post.html               # å‘å¸ƒåŠ¨æ€é¡µé¢
â”‚     â”œâ”€â”€ css/
â”‚     â”œâ”€â”€ js/
â”‚     â””â”€â”€ img/
â”‚
â”œâ”€â”€ posts/                        # åŠ¨æ€æ­£æ–‡ï¼ˆMarkdown æ ¼å¼ï¼‰
â”‚     â”œâ”€â”€ 2025-01-20-1.md         # åŠ¨æ€æ–‡ä»¶
â”‚     â”œâ”€â”€ 2025-01-20-2.md         # åŠ¨æ€æ–‡ä»¶
â”‚     â””â”€â”€ ...                     # æ›´å¤šåŠ¨æ€æ–‡ä»¶
â”‚
â”œâ”€â”€ status/                       # çŠ¶æ€è®°å½•ï¼ˆMarkdown æ ¼å¼ï¼‰
â”‚     â”œâ”€â”€ 2025-01-20-1.md         # æ¯å¤©ä¸€æ¡æˆ–æ¯æ¬¡æ›´æ–°ä¸€æ¡çŠ¶æ€
â”‚     â”œâ”€â”€ 2025-01-20-2.md         # çŠ¶æ€è®°å½•æ–‡ä»¶
â”‚     â””â”€â”€ ...                     # æ›´å¤šå†å²çŠ¶æ€æ–‡ä»¶
â”‚
â””â”€â”€ upload/                       # ä¸Šä¼ å›¾ç‰‡æˆ–èƒŒæ™¯
      â”œâ”€â”€ bg_20250120_1.png
      â””â”€â”€ ...
```

## å­˜å‚¨

### é…ç½®æ–‡ä»¶

```
server:
  host: 127.0.0.1   # æœåŠ¡å™¨åœ°å€
  port: 5000        # ç«¯å£

nickname: Ruibin_Ningh   # æ˜µç§°
avatar: avatar.png        # å¤´åƒæ–‡ä»¶å

api_key: your-api-key-here   # API Key
view_time_limit_days: 7      # å¯è§å¤©æ•°
comment: false               # æ˜¯å¦å¼€å¯è¯„è®º

frontend: 
  # èƒŒæ™¯æ ·å¼é€‰æ‹©
  background:
    # å›¾ç‰‡ ï¼Œ åŠ¨æ€å…‰æ™• ï¼Œ åŠ¨æ€æå…‰
    # "image" , "dynamic-halo" , "dynamic-aurora"
    type: "image"
```

### åŠ¨æ€

åŠ¨æ€æ–‡ä»¶ç¤ºä¾‹

`posts/2025-01-20-1.md`

```
---
time: "2025-01-20 10:00:00"
tags: ["å¾®ä¿¡"]
---

ä»Šå¤©ç»§ç»­å¼€å‘åŠ¨æ€ç³»ç»Ÿï¼Œä¼˜åŒ–äº†çŠ¶æ€ç®¡ç†æ¨¡å—ï¼Œæ•´åˆäº† Markdown æ”¯æŒã€‚  
åœ¨å®ç°åå°åŠŸèƒ½æ—¶é‡åˆ°äº†ä¸€äº›å°é—®é¢˜ï¼Œä½†æˆåŠŸè§£å†³äº†ã€‚

æ­£åœ¨æ€è€ƒå¦‚ä½•ä¼˜åŒ– API æ€§èƒ½ï¼Œæœªæ¥å¯èƒ½ä¼šé‡‡ç”¨ç¼“å­˜æœºåˆ¶æ¥æé«˜å“åº”é€Ÿåº¦ã€‚

```

### çŠ¶æ€

çŠ¶æ€æ–‡ä»¶ç¤ºä¾‹

`status/2025-01-20-1.md`

```
---
time: "2025-01-20 10:00:00"
name: "coding(è‡ªå®šä¹‰)"
icon: "ğŸ’»"
background: "/upload/bg_20250120_1.png"
---

æ­£åœ¨ç¼–å†™åŠ¨æ€ç³»ç»Ÿä»£ç ï¼Œå¿™ç¢Œè€Œå……å®ï¼

```

## æ ‡ç­¾ç³»ç»Ÿ

ä¸ºäº†é‰´åˆ«ä¸€äº›åŠ¨æ€æ¥æºä¹‹ç±»çš„,æˆ‘è®¡åˆ’æ·»åŠ æ ‡ç­¾ç³»ç»Ÿ

ä¸€èˆ¬æ ‡ç­¾ä¾‹å¦‚"å¾®ä¿¡"è¡¨ç¤ºè¿™ä¸ªåŠ¨æ€æ˜¯å’Œä½ çš„å¾®ä¿¡æœ‹å‹åœˆåŒæ­¥çš„,å‰ç«¯æ¸²æŸ“æ—¶åº”è¯¥æç¤º"æ¥è‡ªå¾®ä¿¡æœ‹å‹åœˆ"

## åç«¯ç›¸å…³å˜é‡/API

### è·å–åŸºç¡€ä¿¡æ¯

`GET /api/user/info`

ç¤ºä¾‹è¿”å›

```
{
  "nickname": "Ruibin_Ningh",
  "avatar": "avatar.jpg",
  "post_count": 42,
  "status_count": 8,
  "latest_post_time": "2025-01-20 10:00:00",
  "latest_status_time": "2025-01-19 22:31:05"
}
```

### å‰ç«¯ä¸ªæ€§åŒ–é…ç½®

`GET /api/frontend/config`

ç¤ºä¾‹è¿”å›

```
{
  "background": "image" //èƒŒæ™¯æ¨¡å¼,imageä¸ºç”¨æˆ·è‡ªå®šä¹‰å›¾ç‰‡(è‡ªåŠ¨è·å–background.png),dynamic-haloæ˜¯åŠ¨æ€å…‰æ™•,dynamic-auroraæ˜¯åŠ¨æ€æå…‰
}
```



### è·å–åŠ¨æ€åˆ—è¡¨

`GET /api/posts`

ä¼šè¿”å›åŠ¨æ€çš„åˆ—è¡¨,è¶…è¿‡æœŸé™çš„å†…å®¹ä¸ä¼šæ˜¾ç¤º(å¯é…ç½®)

ç¤ºä¾‹è¿”å›

```
{
  "count": 2, //åŠ¨æ€çš„æ€»æ•°
  "posts": [
    {
      "meta": {
        "time": "2025-01-20 10:00:00",
        "tags": ["å¾®ä¿¡"]
      },
      "html": "<p>æ¸²æŸ“åçš„æ­£æ–‡ HTMLâ€¦â€¦</p>",
      "raw": "---\n...åŸ Markdown...\n",
      "filename": "2025-01-20-1.md"
    },//ç¬¬ä¸€ä¸ªåŠ¨æ€
    {
      "meta": {
        "time": "2025-01-20 10:00:00",
        "tags": ["å¾®ä¿¡"]
      },
      "html": "<p>æ¸²æŸ“åçš„æ­£æ–‡ HTMLâ€¦â€¦</p>",
      "raw": "---\n...åŸ Markdown...\n",
      "filename": "2025-01-20-1.md"
    }//ç¬¬äºŒä¸ªåŠ¨æ€
  ]
}
```

### è·å–å•ä¸ªåŠ¨æ€è¯¦æƒ…

`GET /api/post/<post_id>`

(ä¾‹å¦‚`/api/post/2025-01-20-1`)

```
{
  "meta": {
    "time": "2025-01-20 10:00:00",
    "tags": ["å¾®ä¿¡"]
  },
  "html": "<p>ä»Šå¤©ç»§ç»­å¼€å‘åŠ¨æ€ç³»ç»Ÿï¼Œä¼˜åŒ–äº†çŠ¶æ€ç®¡ç†æ¨¡å—ã€‚</p>",
  "raw": "---\ntime: \"2025-01-20 10:00:00\"\ntags: [\"å¾®ä¿¡\"]\n---\nä»Šå¤©ç»§ç»­å¼€å‘åŠ¨æ€ç³»ç»Ÿï¼Œä¼˜åŒ–äº†çŠ¶æ€ç®¡ç†æ¨¡å—ã€‚",
  "filename": "2025-01-20-1.md"
}
```

### è·å–å½“å‰çŠ¶æ€

`GET /api/status/current`

è¿”å›ç¤ºä¾‹

```
{
  "filename": "2025-11-15-1.md",
  "meta": {
    "time": "2025-11-15 10:00:00",
    "name": "coding(è‡ªå®šä¹‰)",
    "icon": ğŸ’»,
    "background": "/upload/bg_20251115_1.png"
  },
  "raw": "---\ntime: \"2025-11-15 10:00:00\"\nname: \"coding(è‡ªå®šä¹‰)\"\nbackground: \"/upload/bg_20251115_1.png\"\n---\n\nä»Šå¤©æ­£åœ¨å†™åŠ¨æ€ç³»ç»Ÿï¼Œå¿™ç¢Œè€Œå……å®ï¼",
  "html": "<p>ä»Šå¤©æ­£åœ¨å†™åŠ¨æ€ç³»ç»Ÿï¼Œå¿™ç¢Œè€Œå……å®ï¼</p>"
}
```

### è·å–çŠ¶æ€åˆ—è¡¨

`GET /api/status/history`

è¿”å›ç¤ºä¾‹

```
{
  "count": 2,
  "statuses": [
    {
      "filename": "2025-11-15-1.md",
      "meta": {
        "time": "2025-11-15 10:00:00",
        "name": "coding(è‡ªå®šä¹‰)",
        "icon": "ğŸ’»",
        "background": "/upload/bg_20251115_1.png"
      },
      "raw": "---\ntime: \"2025-11-15 10:00:00\"\nname: \"coding(è‡ªå®šä¹‰)\"\nicon: ğŸ’»\nbackground: \"/upload/bg_20251115_1.png\"\n---\n\nä»Šå¤©æ­£åœ¨å†™åŠ¨æ€ç³»ç»Ÿï¼Œå¿™ç¢Œè€Œå……å®ï¼",
      "html": "<p>ä»Šå¤©æ­£åœ¨å†™åŠ¨æ€ç³»ç»Ÿï¼Œå¿™ç¢Œè€Œå……å®ï¼</p>"
    },
    {
      "filename": "2025-11-14-1.md",
      "meta": {
        "time": "2025-11-14 20:31:00",
        "name": "study",
        "icon": "ğŸ“š",
        "background": "/upload/bg_20251114_1.png"
      },
      "raw": "---\ntime: \"2025-11-14 20:31:00\"\nname: \"study\"\nicon: ğŸ“š\nbackground: \"/upload/bg_20251114_1.png\"\n---\n\nä»Šå¤©å¤ä¹ äº†è¯­æ–‡ä¸æ•°å­¦ï¼ŒçŠ¶æ€è‰¯å¥½ï¼",
      "html": "<p>ä»Šå¤©å¤ä¹ äº†è¯­æ–‡ä¸æ•°å­¦ï¼ŒçŠ¶æ€è‰¯å¥½ï¼</p>"
    }
  ]
}

```

### æŸ¥è¯¢åŠ¨æ€

`GET /api/post/query`

| å‚æ•°       | ç±»å‹     | å¿…å¡« | æè¿°                                         |
| ---------- | -------- | ---- | -------------------------------------------- |
| `date`     | `string` | å¯é€‰ | æŒ‰å¤©æŸ¥è¯¢åŠ¨æ€ï¼Œæ ¼å¼ `YYYY-MM-DD`              |
| `filename` | `string` | å¯é€‰ | æŒ‰æ–‡ä»¶åæŸ¥è¯¢å•æ¡åŠ¨æ€ï¼Œä¾‹å¦‚ `2025-11-15-1.md` |
| `limit`    | `int`    | å¯é€‰ | é™åˆ¶è¿”å›æ•°é‡ï¼Œé»˜è®¤ 20                        |
| `offset`   | `int`    | å¯é€‰ | åˆ†é¡µåç§»ï¼Œé»˜è®¤ 0                             |

**æ³¨æ„**ï¼š`date` å’Œ `filename` è‡³å°‘æä¾›ä¸€ä¸ªï¼Œå¦‚æœåŒæ—¶æä¾›åˆ™ä»¥ `filename` ä¼˜å…ˆã€‚

è¿”å›ç¤ºä¾‹ï¼ˆæŒ‰æ—¥æœŸæŸ¥è¯¢ï¼‰

```
{
  "count": 2,
  "posts": [
    {
      "filename": "2025-11-15-1.md",
      "meta": {
        "time": "2025-11-15 10:00:00",
        "tags": ["coding","flask"]
      },
      "raw": "---\ntime: \"2025-11-15 10:00:00\"\ntags: [\"coding\",\"flask\"]\n---\n\nä»Šå¤©å†™äº†åŠ¨æ€æŸ¥è¯¢API",
      "html": "<p>ä»Šå¤©å†™äº†åŠ¨æ€æŸ¥è¯¢API</p>"
    },
    {
      "filename": "2025-11-15-2.md",
      "meta": {
        "time": "2025-11-15 14:30:00",
        "tags": ["review"]
      },
      "raw": "---\ntime: \"2025-11-15 14:30:00\"\ntags: [\"review\"]\n---\n\nå¤ä¹ äº†çŠ¶æ€ç³»ç»Ÿ",
      "html": "<p>å¤ä¹ äº†çŠ¶æ€ç³»ç»Ÿ</p>"
    }
  ]
}
```

è¿”å›ç¤ºä¾‹ï¼ˆæŒ‰æ–‡ä»¶åæŸ¥è¯¢ï¼‰

```
{
  "filename": "2025-11-15-1.md",
  "meta": {
    "time": "2025-11-15 10:00:00",
    "tags": ["coding","flask"]
  },
  "raw": "---\ntime: \"2025-11-15 10:00:00\"\ntags: [\"coding\",\"flask\"]\n---\n\nä»Šå¤©å†™äº†åŠ¨æ€æŸ¥è¯¢API",
  "html": "<p>ä»Šå¤©å†™äº†åŠ¨æ€æŸ¥è¯¢API</p>"
}
```

### å‘é€åŠ¨æ€

```
POST /api/post/new
X-API-KEY: your-api-key
Content-Type: application/json

{
    "content": "ä»Šå¤©æµ‹è¯• API æ–°åŠŸèƒ½",
    "tags": ["æµ‹è¯•","API"],
    "time": "2025-11-15 15:00:00"
}
```

### è®¾ç½®çŠ¶æ€

```
POST /api/status/new
X-API-KEY: your-api-key
Content-Type: application/json

{
    "content": "æ­£åœ¨å¼€å‘ API è®¤è¯åŠŸèƒ½",
    "name": "coding(è‡ªå®šä¹‰)",
    "icon": ğŸ’»
    "background": "/upload/bg_20251115_2.png",
    "time": "2025-11-15 15:30:00"
}
```

### æœç´¢

`GET /api/search`

æ ¹æ®å…³é”®è¯æœç´¢åŠ¨æ€ï¼ˆpostsï¼‰å’ŒçŠ¶æ€ï¼ˆstatusï¼‰ï¼Œè¿”å›åŒ¹é…ç»“æœåˆ—è¡¨ã€‚

| å‚æ•° | ç±»å‹     | å¿…å¡« | æè¿°                                                         |
| ---- | -------- | ---- | ------------------------------------------------------------ |
| `q`  | `string` | å¯é€‰ | æœç´¢å…³é”®è¯ã€‚æ”¯æŒæ™®é€šå­—ç¬¦ä¸²åŒ¹é…ï¼Œä¹Ÿæ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ï¼Œæ ¼å¼ `/pattern/flags`ï¼Œå…¶ä¸­ `flags` å¯é€‰ï¼Œå¸¸ç”¨ `i` è¡¨ç¤ºå¿½ç•¥å¤§å°å†™ã€‚ |

å“åº”ç¤ºä¾‹

```
{
  "count": 2,
  "items": [
    {
      "type": "post",
      "filename": "2025-11-15-1.md",
      "meta": {
        "time": "2025-11-15 10:00:00",
        "tags": ["coding", "flask"]
      },
      "raw": "---\ntime: \"2025-11-15 10:00:00\"\ntags: [\"coding\", \"flask\"]\n---\n\nä»Šå¤©å†™äº†åŠ¨æ€æŸ¥è¯¢API",
      "html": "<p>ä»Šå¤©å†™äº†åŠ¨æ€æŸ¥è¯¢API</p>"
    },
    {
      "type": "status",
      "filename": "2025-11-15-2.md",
      "meta": {
        "time": "2025-11-15 14:30:00",
        "name": "reviewing"
      },
      "raw": "---\ntime: \"2025-11-15 14:30:00\"\nname: \"reviewing\"\n---\n\nå¤ä¹ äº†çŠ¶æ€ç³»ç»Ÿ",
      "html": "<p>å¤ä¹ äº†çŠ¶æ€ç³»ç»Ÿ</p>"
    }
  ]
}

```

### æ–‡ä»¶ç®¡ç†

ä¸Šä¼ æ¥å£ï¼š`POST http://<ä½ çš„æœåŠ¡å™¨>/upload`

ä¸‹è½½æ¥å£ï¼š`GET http://<ä½ çš„æœåŠ¡å™¨>/download/<filename>`

æ–‡ä»¶åˆ—è¡¨æ¥å£ï¼š`GET http://<ä½ çš„æœåŠ¡å™¨>/files`

**å®‰å…¨éªŒè¯**:æ‰€æœ‰æ¥å£éƒ½éœ€è¦åœ¨ **è¯·æ±‚å¤´**ä¸­åŠ ä¸Š `X-API-KEY`ï¼š

```
X-API-KEY: <ä½ çš„API_KEY>
```

#### ä¸Šä¼ æ–‡ä»¶

æ–¹æ³•ï¼š`POST`

Content-Typeï¼š`multipart/form-data`

å‚æ•°ï¼š

- `file`ï¼šè¦ä¸Šä¼ çš„æ–‡ä»¶

è¿”å›ç¤ºä¾‹

```
{
  "message": "File uploaded",
  "filename": "example.txt",
  "url": "http://127.0.0.1:5000/download/example.txt"
}
```

#### ä¸‹è½½æ–‡ä»¶

æ–¹æ³•ï¼š`GET`

URLï¼š`/download/<filename>`

#### è·å–æ–‡ä»¶åˆ—è¡¨

æ–¹æ³•ï¼š`GET`

URLï¼š`/files`

è¯·æ±‚å¤´åŒæ ·éœ€è¦ `X-API-KEY`

è¿”å›ç¤ºä¾‹

```
{
  "files": [
    {
      "name": "bg_20251115_1.png",
      "size": 384294,
      "size_human": "375 KB",
      "modified": "2025-11-15 10:00:23"
    },
    {
      "name": "example.txt",
      "size": 82,
      "size_human": "82 B",
      "modified": "2025-11-14 09:11:05"
    }
  ]
}
```

| å­—æ®µ         | å«ä¹‰                                      |
| ------------ | ----------------------------------------- |
| `name`       | æ–‡ä»¶å                                    |
| `size`       | æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰                          |
| `size_human` | äººç±»å¯è¯»æ ¼å¼ï¼ˆKBã€MB è‡ªåŠ¨è½¬æ¢ï¼‰           |
| `modified`   | æœ€åä¿®æ”¹æ—¶é—´ï¼ˆæ ¼å¼ï¼šYYYY-MM-DD HH:MM:SSï¼‰ |

## è¿è¡Œ

```
python server.py
```
å¯åŠ¨æœåŠ¡å™¨